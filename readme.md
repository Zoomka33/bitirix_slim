# Видение проекта на Битриксе реализованно с помощью Slim 4 framework
!Необходима версия php8 и выше! 
***
Точка входа для запроса `/index.php`

Перенаправлением занимается битрикс, файл `/urlrewrite.php`

В папке `/App` - классы сайта

В папке `/http` - все конфигурационные файлы

В папке `/bitrix` - ядро битрикса

В папке `/resources` - html, css, js, sass и тд

В папку `/storage` - логи

В папке `/tests` - тесты

В папке `/upload` - папка с картинками

В папке `/vendor` - библиотеки композера

С БД общение идет через Bitrix ORM (`/App/Tables/`)

Namespace - `/App/`

***

### Общие положения

Доступы до внешних сервисов хранятся в `/http/.env`

Роуты в `/http/routes.php`

Миддлвары в `/http/middleware.php`

Slim Framework версии **4**
***
### Архитектура папки `/App/`

`Controller` - контроллеры

Логику контроллеров делим на Репозитории (`/App/Repositories/`) - получение данных,
и сервисы (`/App/Service/`) - добавление/удаление/изменение данных

Внутри сервисов/репозиториев организуется любая архитектура класса

***

### Bitrix ORM

По возможности, при использовании ORM используются магические методы для инфоблоков

Каждый репозиторий/сервис хранить магический класс таблицы
с которой он работает

Пример `\Bitrix\Iblock\Elements\ElementProductsTable`

Джоин таблиц происходит в рантайме
***

### Роутинг

#### Именование роутов:

->setName('parent_code.type');

Где:

parent_code - url страницы, раздела и тд (каталог, новости, блог)

type - тип запроса (список, индекс, запись)

Пример: ->setName('catalog.index');

#### Общие положения:

Обязательно `/` на конце роута

***

### View

Самописный шаблонизатор, статичный класс

Имеет возможность вывода 
именованных роутов (аналог `route()` из Laravel)
(работает только после вызова `renderHtml()`)

По умолчанию нужно возвращать объект класса `View` 
в контроллере через метод `$this->view()` 

Шаблоны хранятся в папке `/App/Templates/`

Если путь до шаблона имеет вложенность то вызов через `.`

Пример: `catalog.index`, `layout.header` и тд

**Именование шаблонов соответствует именованию роутов**

***

### Используемые библиотеки

slim/slim - слим роутер

slim/psr7 - библиотека для слима

symfony/var-dumper - дампер (v 4.4)

symfony/dotenv - .env

predis/predis - редис кэш

если версия php < 8.1, то
в composer.json необходимо вставить:
`"config": {
    "platform-check": false
}`
